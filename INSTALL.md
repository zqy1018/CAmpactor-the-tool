# Instructions for Building *CAmpactor*

**Note:** There are some requirements of *CAmpactor* listed in [REQUIREMENTS.md](REQUIREMENTS.md). We recommend users check them before building and running *CAmpactor*. 

We have prepared a shell script `build.sh` in the root directory. To execute it, the user may use the following command: 

```
bash build.sh
```

By executing this script file, users can build both *SamplingCA* and *CAmpactor*. Note that both *SamplingCA* and *CAmpactor* should be built on a 64-bit GNU/Linux operating system. 

**Tip:** Both *SamplingCA* and *CAmpactor* depend on *MiniSAT*, but *MiniSAT* may not compile successfully when using specific versions of `g++`. In this case, users may seek for solutions on the Internet or in [the Github page of *MiniSAT*](https://github.com/niklasso/minisat), or contact us for help. 

# Quick Installation Testing

To check whether the compilation is successful or not, the user may run the following command in the root directory: 

```
bash simple_run.sh 1 cnf_benchmarks/toybox.cnf toybox_PCA.out
```

The command above executes the `simple_run.sh` script, the arguments of which are briefly described in the [README file](README.md#example-command-for-running-campactor). By running the command above, the user should be able to find a PCA for the benchmark `cnf_benchmarks/toybox.cnf` in `./toybox_PCA.out`, which is initially constructed by *SamplingCA* and then optimized by *CAmpactor*. 

The console output is expected to be similar with the following text:

```
c now call SamplingCA to generate an initial PCA
...
...  <-- possibly some huge amount of output by Coprocessor
...
1: 147696
2: 215991
3: 237082
4: 243242
5: 248422
6: 251124
7: 252954
8: 254288
9: 255126
10: 255634
11: 255950
12: 256174
13: 256338
14: 256414
15: 256458
16: 256486
17: 256494

c Clear final: fix-up all remaining tuples ...
c All possible 2-tuple number: 256494
c 2-tuple coverage: 1
c Generate testcase set finished, containing 17 testcases!
c CPU time cost by generating testcase set: 0.529 seconds
c Testcase set saved in ./SamplingCA/toybox_PCA.out
c 2-tuple number of generated testcase set: 256494
c now call CAmpactor to optimize the initial PCA
...
...  <-- possibly some huge amount of output by Coprocessor
...
c read PCA from SamplingCA/toybox_PCA.out; initial size = 17
c current PCA size: 17, step #0 
c current PCA size: 16, step #17 
c current PCA size: 15, step #57 
c current PCA size: 14, step #73 
c total tuple num = 256494
c CPU time cost by optimization: 2.263 seconds
c optimized PCA saved in toybox_PCA.out
```

Here, the output lines between `c now call SamplingCA to generate an initial PCA` and `c now call CAmpactor to optimize the initial PCA` are the output of *SamplingCA*. The user can know from the line `c Generate testcase set finished, containing 17 testcases!` that the PCA generated by *SamplingCA* contains 17 test cases, and there are 256494 valid pairwise tuples covered by the PCA in total. 

The output lines after `c now call CAmpactor to optimize the initial PCA` are the output of *CAmpactor*. The user can see that the size of PCA is decreasing from 17 to 14, while the number of covered pairwise tuples remains 256494. And finally, *CAmpactor* writes the optimized PCA (containing 14 test cases) to `./toybox_PCA.out`. 

We finally note that due to potential differences in the random number generation mechanism over different versions of `g++`, the size of the generated PCA on the user's machine may be slightly different from the one presented here. 
